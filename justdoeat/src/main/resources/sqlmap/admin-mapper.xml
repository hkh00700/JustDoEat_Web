<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="admin.mapper">
	<select id="list" resultType="admin.CustomerVO">
		select * from member order by m_nikname
	</select>
	
 	<select id="detail" resultType="admin.CustomerVO">
		select * from member where m_uq = #{m_uq}
	</select> 
	
	<update id="update">
		update member set m_email = #{m_email}, m_id = #{m_id}, m_pw = #{m_pw}, m_name = #{m_name}, m_phone = #{m_phone},
		m_gender = #{m_gender}, m_nikname = #{m_nikname}, m_addr1 = #{m_addr1}, m_addr2 = #{m_addr2}, m_allergy = #{m_allergy},
		admin = #{admin}
		where m_uq = #{m_uq}
	</update>
	
	<delete id="delete">
		delete from member where m_uq = #{m_uq}
	</delete>
	
	<sql id='where_search'>
	<if test="search == 'all'">
		where m_name like '%' || #{keyword} || '%'
		or m_email like '%' || #{keyword} || '%'
		or m_nikname like '%' || #{keyword} || '%'
	</if>
	<if test= "search == 'm_name' or search == 'm_email' or search == 'm_nikname' ">
		where #{search} like '%' || #{keyword} || '%'
	</if> 
	</sql>
	
	<select id="search" resultType="admin.CustomerVO">
		select * from member <include refid="where_search"></include>
	</select>
	
	

</mapper>